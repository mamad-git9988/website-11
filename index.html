<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MaDMaN</title>
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="style.css">
    <style>
        #userDashboard { text-align: center; }
        #adminMsg {
            width: 100%; height: 100px; background: rgba(0,0,0,0.3); 
            color: white; border: 1px solid #00f260; border-radius: 10px; 
            padding: 10px; margin-top: 10px; font-family: Vazirmatn;
        }
        .dash-btn {
            width: 100%; padding: 12px; background: #00f260; color: black; 
            border: none; border-radius: 10px; cursor: pointer; 
            margin-top: 10px; font-weight: bold; font-family: Vazirmatn;
        }
    </style>
</head>
<body>
    <div class="loader" id="loader">
        <div class="loader-text">MADMAN</div>
        <div class="card-icon">ğŸ’»</div>
    </div>
    
    <a href="./index-1.html"><button class="clse-btn"><</button></a>
    <div class="particles" id="particles"></div>

    <div class="container" id="mainMenu">
        <div class="header">
            <h1>MADMAN</h1>
            <p>Content Crator & Gamer & programmer</p>
        </div>
        <div class="menu-grid">
            <div class="menu-card" onclick="openSection('che')">
                <span class="card-icon">?</span>
                <h2 class="card-title">Ú†Ú¯ÙˆÙ†Ù‡ØŸØŸØŸ</h2>
                <p class="card-desc">Ú†Ú¯ÙˆÙ†Ù‡ Ø§ÛŒÙ† Ú¯ÙˆÙ†Ù‡ Ø´Ø¯ØŸØŸØŸ</p>
            </div>
            <div class="menu-card" onclick="openSection('specs')">
                <span class="card-icon">ğŸ–¥ï¸</span>
                <h2 class="card-title">Ù…Ø´Ø®ØµØ§Øª Ø³ÛŒØ³ØªÙ…</h2>
                <p class="card-desc">Ø³Ø®Øªâ€ŒØ§ÙØ²Ø§Ø± Ú©Ù‡ Ø¨Ø§Ù‡Ø§Ø´ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù…</p>
            </div>
            <div class="menu-card" onclick="openSection('social')">
                <span class="card-icon">ğŸŒ</span>
                <h2 class="card-title">Ø´Ø¨Ú©Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø¬ØªÙ…Ø§Ø¹ÛŒ</h2>
                <p class="card-desc">Ù„ÛŒÙ†Ú© Ú©Ø§Ù†Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ù…Ù† Ø¯Ø± Ø¢Ù¾Ø§Ø±Ø§ØªØŒ ÛŒÙˆØªÛŒÙˆØ¨ Ùˆ Ø±ÙˆØ¨ÛŒÚ©Ø§</p>
            </div>
            <div class="menu-card" onclick="openSection('user')">
                <span class="card-icon">ğŸ‘¤</span>
                <h2 class="card-title">Ù¾Ù†Ù„ Ú©Ø§Ø±Ø¨Ø±ÛŒ</h2>
                <p class="card-desc" id="userStatus">ÙˆØ§Ø±Ø¯ Ø­Ø³Ø§Ø¨ Ø®ÙˆØ¯ Ø´ÙˆÛŒØ¯</p>
            </div>
        </div>
    </div>
    <div class="content-section" id="cheSection">
        <button class="close-btn" onclick="closeSection()">ğŸ </button>
        <div class="section-content">
            <div class="about-box">
                <p class="about-text">
                    Ø³Ù„Ø§Ù…! Ù…Ù† <span class="highlight">ÛŒÚ© ØªÙˆØ³Ø¹Ù‡â€ŒØ¯Ù‡Ù†Ø¯Ù‡</span> Ù‡Ø³ØªÙ… ğŸ‘‹<br><br>
                    Ù…ØªÙˆÙ„Ø¯ <span class="highlight"> Ø§Ø³ÙÙ†Ø¯ Ù…Ø§Ù‡ 1394 </span> Ùˆ Ø§Ø² Ø³Ø§Ù„ <span class="highlight">1405</span> Ù‡Ø³Øª Ú©Ù‡ ÙØ¹Ø§Ù„ÛŒØª Ø®ÙˆØ¯Ù… Ø±Ùˆ ØªÙˆÛŒ 
                    <span class="highlight">Ø¢Ù¾Ø§Ø±Ø§Øª</span> Ø´Ø±ÙˆØ¹ Ú©Ø±Ø¯Ù….<br><br>
                    Ø§Ù„Ø¨ØªÙ‡ Ø´Ø§ÛŒØ¯ Ø¨Ú¯ÛŒØ¯ Ù…Ù† Û±Û° Ø³Ø§Ù„Ù‡ Ú©ÙˆØ¬Ø§ ØŸØŸØŸØŸ Ø§ÛŒÙ†Ø¬Ø§ Ú©ÙˆØ¬Ø§ØŸØŸØŸ
                    Ø±Ø§Ø³ØªØ´ Ø±Ùˆ Ø¨Ø®ÙˆØ§ÛŒÙ† Ù…Ù† ÙˆØ§Ø±Ø¯ <span class="highlight">Ø¯Ù†ÛŒØ§ÛŒ Ú©Ø§Ù…Ù¾ÛŒØªØ± Ù‡Ø³ØªÙ…</span>
                    <br>
                    Ø§Ú¯Ø± ØªØ§Ø²Ù‡ Ù…Ù†Ùˆ Ù…ÛŒØ´Ù†Ø§Ø³ÛŒ Ø­ØªÙ…Ø§ <span class="highlight">Ø¨Ø´Ù†Ø§Ø³!!!!!!!</span>
                    <span style="font-size: 2rem;">ğŸ®</span>
                </p>
            </div>
        </div>
    </div>

    <div class="content-section" id="userSection">
        <button class="close-btn" onclick="closeSection()">ğŸ </button>
        <div class="section-content">
            <div class="about-box">
                <div id="loginForm">
                    <h2 class="highlight" id="userTitle">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ</h2>
                    <br>
                    <div style="max-width: 400px; margin: 0 auto; display: flex; flex-direction: column; gap: 15px;">
                        <input type="text" id="username" placeholder="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ" style="padding: 15px; border-radius: 10px; border: 1px solid #00f260; background: rgba(0,0,0,0.3); color: white; text-align: center;">
                        <input type="password" id="password" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±" style="padding: 15px; border-radius: 10px; border: 1px solid #00f260; background: rgba(0,0,0,0.3); color: white; text-align: center;">
                        <div style="display: flex; gap: 10px; justify-content: center;">
                            <button onclick="handleRegister()" class="close-btn" style="position: static; width: auto; padding: 10px 20px; background: #555;">Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</button>
                            <button onclick="handleLogin()" class="close-btn" style="position: static; width: auto; padding: 10px 20px; background: #00f260; color: black;">ÙˆØ±ÙˆØ¯</button>
                        </div>
                        <p id="authMsg" style="margin-top: 15px; font-size: 0.9rem;"></p>
                    </div>
                </div>

                <div id="userDashboard" style="display: none;">
                    <h2 class="highlight">Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØŒ <span id="displayUserName"></span>! ğŸ”¥</h2>
                    <div style="margin-top: 25px; text-align: right;">
                        <label>Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø¨Ù‡ Ø³Ø±ÙˆØ± (API):</label>
                        <textarea id="adminMsg" placeholder="Ú†ÛŒØ²ÛŒ Ø¨Ù†ÙˆÛŒØ³..."></textarea>
                        <button onclick="sendMessageToAPI()" class="dash-btn">Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ API ğŸš€</button>
                        <p id="msgStatus" style="margin-top: 10px; font-size: 0.9rem; text-align: center;"></p>
                    </div>
                    <button onclick="handleSignOut()" class="close-btn" style="position: static; margin-top: 20px; background: #ff4444; width: 100%;">Ø®Ø±ÙˆØ¬ Ø§Ø² Ø­Ø³Ø§Ø¨</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Ø¢Ø¯Ø±Ø³ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ ØªÙˆ
const SHEETDB_URL = 'https://sheetdb.io/api/v1/m49pef60egnbd';

// Û±. Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ù„ÙˆØ¯Ø± Ø§ÙˆÙ„ Ø³Ø§ÛŒØª
window.addEventListener('load', () => {
    const loader = document.getElementById('loader');
    if (loader) {
        setTimeout(() => {
            loader.style.opacity = '0';
            setTimeout(() => {
                loader.style.display = 'none';
            }, 500);
        }, 1000);
    }
});

// Û². Ø§ÛŒØ¬Ø§Ø¯ Ø°Ø±Ø§Øª Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ (Particles)
function createParticles() {
    const container = document.getElementById('particles');
    if (!container) return;
    for (let i = 0; i < 50; i++) {
        const p = document.createElement('div');
        p.className = 'particle';
        p.style.left = Math.random() * 100 + '%';
        p.style.animationDelay = Math.random() * 15 + 's';
        p.style.animationDuration = (Math.random() * 10 + 10) + 's';
        container.appendChild(p);
    }
}
createParticles();

// Û³. Ù…Ø¯ÛŒØ±ÛŒØª Ø¨Ø§Ø² Ùˆ Ø¨Ø³ØªÙ‡ Ú©Ø±Ø¯Ù† Ø¨Ø®Ø´â€ŒÙ‡Ø§ (Sections)
function openSection(name) {
    document.getElementById('mainMenu').style.display = 'none';
    document.querySelectorAll('.content-section').forEach(s => s.style.display = 'none');
    
    const target = document.getElementById(name + 'Section');
    if (target) {
        target.style.display = 'block';
    }
    
    // Ø§Ú¯Ø± Ù¾Ù†Ù„ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¨Ø§Ø² Ø´Ø¯ØŒ ÙˆØ¶Ø¹ÛŒØª Ø±Ùˆ Ú†Ú© Ú©Ù†
    if (name === 'user') updateUI();
}

function closeSection() {
    document.querySelectorAll('.content-section').forEach(s => s.style.display = 'none');
    document.getElementById('mainMenu').style.display = 'flex';
}

// Û´. Ø³ÛŒØ³ØªÙ… Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯
async function handleRegister() {
    const user = document.getElementById('username').value;
    const pass = document.getElementById('password').value;
    const msg = document.getElementById('authMsg');

    if (!user || !pass) {
        msg.innerText = "ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ùˆ Ù¾Ø± Ú©Ù†!";
        return;
    }

    msg.innerText = "Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ...";
    try {
        const check = await fetch(`${SHEETDB_URL}/search?username=${user}`);
        const exist = await check.json();

        if (exist.length > 0) {
            msg.innerText = "Ø§ÛŒÙ† ÛŒÙˆØ²Ø±Ù†ÛŒÙ… Ù‚Ø¨Ù„Ø§Ù‹ Ø«Ø¨Øª Ø´Ø¯Ù‡! âŒ";
        } else {
            await fetch(SHEETDB_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ data: [{ username: user, password: pass }] })
            });
            msg.innerText = "Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø´Ø¯! Ø­Ø§Ù„Ø§ ÙˆØ§Ø±Ø¯ Ø´Ùˆ âœ…";
        }
    } catch (e) {
        msg.innerText = "Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø¯ÛŒØªØ§Ø¨ÛŒØ³!";
    }
}

// Ûµ. Ø³ÛŒØ³ØªÙ… ÙˆØ±ÙˆØ¯ (Login)
async function handleLogin() {
    const user = document.getElementById('username').value;
    const pass = document.getElementById('password').value;
    const msg = document.getElementById('authMsg');

    msg.innerText = "Ø¯Ø± Ø­Ø§Ù„ ÙˆØ±ÙˆØ¯...";
    try {
        const res = await fetch(`${SHEETDB_URL}/search?username=${user}`);
        const data = await res.json();

        if (data.length > 0 && data[0].password == pass) {
            localStorage.setItem('isLoggedIn', 'true');
            localStorage.setItem('currentUser', user);
            updateUI();
        } else {
            msg.innerText = "ÛŒÙˆØ²Ø±Ù†ÛŒÙ… ÛŒØ§ Ù¾Ø³ÙˆØ±Ø¯ ØºÙ„Ø·Ù‡! âŒ";
        }
    } catch (e) {
        msg.innerText = "Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø±Ù‚Ø±Ø§Ø±ÛŒ Ø§Ø±ØªØ¨Ø§Ø·!";
    }
}

// Û¶. Ø®Ø±ÙˆØ¬ Ø§Ø² Ø­Ø³Ø§Ø¨
function handleSignOut() {
    localStorage.clear();
    updateUI();
}

// Û·. Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ (Ø³ÛŒØ³ØªÙ… Ú†Ú© Ú©Ø±Ø¯Ù†)
function updateUI() {
    const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
    const user = localStorage.getItem('currentUser');
    
    const loginForm = document.getElementById('loginForm');
    const dashboard = document.getElementById('userDashboard');
    const userStatus = document.getElementById('userStatus');
    const displayUser = document.getElementById('displayUserName');

    if (isLoggedIn) {
        if (loginForm) loginForm.style.display = 'none';
        if (dashboard) dashboard.style.display = 'block';
        if (displayUser) displayUser.innerText = user;
        if (userStatus) userStatus.innerText = "Ø³Ù„Ø§Ù… " + user + " Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒ!";
    } else {
        if (loginForm) loginForm.style.display = 'block';
        if (dashboard) dashboard.style.display = 'none';
        if (userStatus) userStatus.innerText = "ÙˆØ§Ø±Ø¯ Ø­Ø³Ø§Ø¨ Ø®ÙˆØ¯ Ø´ÙˆÛŒØ¯";
    }
}

// Û¸. Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø¨Ù‡ API
async function sendMessageToAPI() {
    const text = document.getElementById('adminMsg').value;
    const user = localStorage.getItem('currentUser') || "Ù†Ø§Ø´Ù†Ø§Ø³";
    const status = document.getElementById('msgStatus');

    if (!text) return;
    status.innerText = "Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„...";

    try {
        await fetch('/api/contact', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ sender: user, text: text })
        });
        status.innerText = "Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯! âœ…";
        document.getElementById('adminMsg').value = "";
    } catch (e) {
        status.innerText = "Ø®Ø·Ø§ÛŒ Ø³Ø±ÙˆØ± âŒ";
    }
}

// Ø§Ø¬Ø±Ø§ÛŒ Ú†Ú© Ú©Ø±Ø¯Ù† ÙˆØ¶Ø¹ÛŒØª Ø¨Ù‡ Ù…Ø­Ø¶ Ù„ÙˆØ¯ Ø´Ø¯Ù† Ú©Ø¯
updateUI();
    </script>
</body>
</html>